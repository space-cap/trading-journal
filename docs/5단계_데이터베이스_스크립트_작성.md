# ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± ì™„ë£Œ

## ğŸ“‹ ì‘ì—… ìš”ì•½

Trading Journal í”„ë¡œì íŠ¸ì˜ MySQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ê¸° ìœ„í•œ SQL ìŠ¤í¬ë¦½íŠ¸ 9ê°œë¥¼ `database/scripts` í´ë”ì— ìƒì„±í–ˆìŠµë‹ˆë‹¤.

## âœ… ìƒì„±ëœ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼

### 1. 01_create_database.sql
**í¬ê¸°**: ~800 bytes  
**ë‚´ìš©**:
- `trading_journal` ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
- ë¬¸ìì…‹: utf8mb4
- ì½œë ˆì´ì…˜: utf8mb4_unicode_ci
- ë°ì´í„°ë² ì´ìŠ¤ ì •ë³´ í™•ì¸ ì¿¼ë¦¬

### 2. 02_create_tables.sql
**í¬ê¸°**: ~4.2 KB  
**ë‚´ìš©**:
- **trades í…Œì´ë¸”** (12ê°œ ì»¬ëŸ¼)
  - ê¸°ë³¸í‚¤: trade_id
  - ë§¤ë§¤ ì •ë³´: symbol, entry_price, quantity, fee, reason, entry_date
  - ì²­ì‚° ì •ë³´: exit_price, exit_date
  - ë©”íƒ€ë°ì´í„°: created_at, updated_at, deleted_at
  - 9ê°œ CHECK ì œì•½ì¡°ê±´
- **users í…Œì´ë¸”** (ì£¼ì„ ì²˜ë¦¬, Phase 2ìš©)
- í…Œì´ë¸” ìƒì„± í™•ì¸ ì¿¼ë¦¬

### 3. 03_create_indexes.sql
**í¬ê¸°**: ~1.8 KB  
**ë‚´ìš©**:
- **5ê°œ ì¸ë±ìŠ¤ ìƒì„±**
  1. idx_trades_symbol (ì¢…ëª©ë³„ ì¡°íšŒ)
  2. idx_trades_entry_date (ê¸°ê°„ë³„ ì¡°íšŒ)
  3. idx_trades_deleted_at (ë…¼ë¦¬ ì‚­ì œ í•„í„°ë§)
  4. idx_trades_symbol_entry_date (ë³µí•© ì¡°íšŒ)
  5. idx_trades_exit_price (ì²­ì‚° ì—¬ë¶€ ì¡°íšŒ)
- ì¸ë±ìŠ¤ í¬ê¸° í™•ì¸ ì¿¼ë¦¬

### 4. 04_create_views.sql
**í¬ê¸°**: ~3.5 KB  
**ë‚´ìš©**:
- **5ê°œ ë·° ìƒì„±**
  1. v_active_trades (í™œì„± ë§¤ë§¤)
  2. v_closed_trades (ì²­ì‚° ì™„ë£Œ)
  3. v_open_trades (ì§„í–‰ ì¤‘)
  4. v_trade_statistics (ì „ì²´ í†µê³„)
  5. v_trades_by_symbol (ì¢…ëª©ë³„ í†µê³„)
- ê³„ì‚° ì†ì„±: realized_pnl, investment_amount, return_rate, holding_days

### 5. 05_create_triggers.sql
**í¬ê¸°**: ~2.8 KB  
**ë‚´ìš©**:
- **2ê°œ íŠ¸ë¦¬ê±° ìƒì„±**
  1. trg_trades_before_insert
     - ì¢…ëª© ì½”ë“œ ëŒ€ë¬¸ì ë³€í™˜ ë° ê³µë°± ì œê±°
     - ë¯¸ë˜ ë‚ ì§œ ë°©ì§€
     - ìˆ˜ìˆ˜ë£Œ ê¸°ë³¸ê°’ ì„¤ì •
  2. trg_trades_before_update
     - ì‚­ì œëœ ë ˆì½”ë“œ ìˆ˜ì • ë°©ì§€
     - ì§„ì… ì •ë³´ ìˆ˜ì • ë°©ì§€
     - ì²­ì‚° ì¼ì‹œ ê²€ì¦
- ê°ì‚¬ ë¡œê·¸ íŠ¸ë¦¬ê±° (ì£¼ì„ ì²˜ë¦¬)

### 6. 06_create_procedures.sql
**í¬ê¸°**: ~5.2 KB  
**ë‚´ìš©**:
- **4ê°œ ì €ì¥ í”„ë¡œì‹œì € ìƒì„±**
  1. sp_close_trade (ë§¤ë§¤ ì²­ì‚°)
     - íŒŒë¼ë¯¸í„°: trade_id, exit_price, exit_date
     - ê²€ì¦: ì¡´ì¬ ì—¬ë¶€, ì‚­ì œ ìƒíƒœ, ë‚ ì§œ ìœ íš¨ì„±
  2. sp_soft_delete_trade (ë…¼ë¦¬ ì‚­ì œ)
     - íŒŒë¼ë¯¸í„°: trade_id
     - deleted_at ì»¬ëŸ¼ ì—…ë°ì´íŠ¸
  3. sp_restore_trade (ì‚­ì œ ë³µì›)
     - íŒŒë¼ë¯¸í„°: trade_id
     - deleted_at NULLë¡œ ì„¤ì •
  4. sp_get_trade_statistics (ê¸°ê°„ë³„ í†µê³„)
     - íŒŒë¼ë¯¸í„°: start_date, end_date
     - ë°˜í™˜: ì´ ë§¤ë§¤, ì²­ì‚°, ì§„í–‰ ì¤‘, ì†ìµ, ìŠ¹ë¥ 

### 7. 07_insert_initial_data.sql
**í¬ê¸°**: ~2.5 KB  
**ë‚´ìš©**:
- **8ê°œ ìƒ˜í”Œ ë§¤ë§¤ ë°ì´í„°**
  - ì²­ì‚° ì™„ë£Œ (ìˆ˜ìµ): 4ê±´
  - ì²­ì‚° ì™„ë£Œ (ì†ì‹¤): 2ê±´
  - ì§„í–‰ ì¤‘: 2ê±´
  - ì¢…ëª©: AAPL, TSLA, MSFT, 005930, 035420, GOOGL, NVDA, AMZN
- ë°ì´í„° í™•ì¸ ì¿¼ë¦¬

### 8. 99_rollback.sql
**í¬ê¸°**: ~2.0 KB  
**ë‚´ìš©**:
- **ëª¨ë“  ê°ì²´ ì‚­ì œ (ì—­ìˆœ)**
  1. ì €ì¥ í”„ë¡œì‹œì € ì‚­ì œ (4ê°œ)
  2. íŠ¸ë¦¬ê±° ì‚­ì œ (2ê°œ)
  3. ë·° ì‚­ì œ (5ê°œ)
  4. í…Œì´ë¸” ì‚­ì œ (trades, users)
  5. ë°ì´í„°ë² ì´ìŠ¤ ì‚­ì œ (ì£¼ì„ ì²˜ë¦¬)
- 5ì´ˆ ëŒ€ê¸° (ì•ˆì „ì¥ì¹˜)
- ì‚­ì œ í™•ì¸ ì¿¼ë¦¬

### 9. README.md
**í¬ê¸°**: ~4.5 KB  
**ë‚´ìš©**:
- ìŠ¤í¬ë¦½íŠ¸ ê°œìš” ë° íŒŒì¼ ëª©ë¡
- ì‹¤í–‰ ë°©ë²• (3ê°€ì§€)
  - MySQL CLI
  - ëª…ë ¹ì¤„ ì§ì ‘ ì‹¤í–‰
  - ì¼ê´„ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
- ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡° ì„¤ëª…
- ì‚¬ìš© ì˜ˆì‹œ (í”„ë¡œì‹œì €, ë·° ì¡°íšŒ)
- ì£¼ì˜ì‚¬í•­ (ìš´ì˜ í™˜ê²½, ë°±ì—…, ê¶Œí•œ)
- ì°¸ê³  ë¬¸ì„œ ë§í¬

## ğŸ“Š ìŠ¤í¬ë¦½íŠ¸ í†µê³„

| í•­ëª© | ìˆ˜ëŸ‰ |
|------|------|
| **ì´ íŒŒì¼ ìˆ˜** | 9ê°œ |
| **ì´ í¬ê¸°** | ~27 KB |
| **ë°ì´í„°ë² ì´ìŠ¤** | 1ê°œ (trading_journal) |
| **í…Œì´ë¸”** | 1ê°œ (trades) + 1ê°œ (users, ì£¼ì„) |
| **ì¸ë±ìŠ¤** | 5ê°œ |
| **ë·°** | 5ê°œ |
| **íŠ¸ë¦¬ê±°** | 2ê°œ |
| **ì €ì¥ í”„ë¡œì‹œì €** | 4ê°œ |
| **ìƒ˜í”Œ ë°ì´í„°** | 8ê±´ |

## ğŸ¯ ì£¼ìš” íŠ¹ì§•

### 1. ì²´ê³„ì ì¸ íŒŒì¼ êµ¬ì¡°
- âœ… ë²ˆí˜¸ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ (01 â†’ 07)
- âœ… ê° ìŠ¤í¬ë¦½íŠ¸ì˜ ì—­í•  ëª…í™•íˆ ë¶„ë¦¬
- âœ… ë¡¤ë°± ìŠ¤í¬ë¦½íŠ¸ ë³„ë„ ì œê³µ (99)

### 2. ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥
- âœ… 9ê°œ CHECK ì œì•½ì¡°ê±´
- âœ… íŠ¸ë¦¬ê±°ë¥¼ í†µí•œ ìë™ ê²€ì¦
- âœ… ì €ì¥ í”„ë¡œì‹œì € ë‚´ ê²€ì¦ ë¡œì§

### 3. ì„±ëŠ¥ ìµœì í™”
- âœ… 5ê°œ ì¸ë±ìŠ¤ (ë‹¨ì¼ + ë³µí•©)
- âœ… ë·°ë¥¼ í†µí•œ ë³µì¡í•œ ì¿¼ë¦¬ ë‹¨ìˆœí™”
- âœ… ì»¤ë²„ë§ ì¸ë±ìŠ¤ ì˜µì…˜ ì œê³µ

### 4. ê°œë°œ í¸ì˜ì„±
- âœ… ìƒ˜í”Œ ë°ì´í„° 8ê±´ ì œê³µ
- âœ… ì €ì¥ í”„ë¡œì‹œì €ë¡œ ë°˜ë³µ ì‘ì—… ìë™í™”
- âœ… ë·°ë¡œ ê³„ì‚° ì†ì„± ì œê³µ (realized_pnl, return_rate)

### 5. ì•ˆì „ì„±
- âœ… ë¡¤ë°± ìŠ¤í¬ë¦½íŠ¸ 5ì´ˆ ëŒ€ê¸°
- âœ… ìš´ì˜ í™˜ê²½ ì£¼ì˜ì‚¬í•­ ëª…ì‹œ
- âœ… ì‚­ì œëœ ë ˆì½”ë“œ ìˆ˜ì • ë°©ì§€

## ğŸ“ íŒŒì¼ ìœ„ì¹˜

```
trading-journal/
â””â”€â”€ database/
    â””â”€â”€ scripts/
        â”œâ”€â”€ 01_create_database.sql
        â”œâ”€â”€ 02_create_tables.sql
        â”œâ”€â”€ 03_create_indexes.sql
        â”œâ”€â”€ 04_create_views.sql
        â”œâ”€â”€ 05_create_triggers.sql
        â”œâ”€â”€ 06_create_procedures.sql
        â”œâ”€â”€ 07_insert_initial_data.sql
        â”œâ”€â”€ 99_rollback.sql
        â””â”€â”€ README.md
```

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### ì „ì²´ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ (ìˆœì„œëŒ€ë¡œ)

```bash
# MySQL CLIì—ì„œ
mysql -u root -p

source database/scripts/01_create_database.sql
source database/scripts/02_create_tables.sql
source database/scripts/03_create_indexes.sql
source database/scripts/04_create_views.sql
source database/scripts/05_create_triggers.sql
source database/scripts/06_create_procedures.sql
source database/scripts/07_insert_initial_data.sql
```

### ê°œë³„ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ (Windows PowerShell)

```powershell
Get-Content .\database\scripts\01_create_database.sql | mysql -u root -p
```

## ğŸ’¡ ì‚¬ìš© ì˜ˆì‹œ

### ë§¤ë§¤ ì²­ì‚°
```sql
CALL sp_close_trade(1, 155.00, '2024-01-20 15:45:00');
```

### í™œì„± ë§¤ë§¤ ì¡°íšŒ
```sql
SELECT * FROM v_active_trades;
```

### ì „ì²´ í†µê³„ ì¡°íšŒ
```sql
SELECT * FROM v_trade_statistics;
```

### ê¸°ê°„ë³„ í†µê³„
```sql
CALL sp_get_trade_statistics('2024-01-01', '2024-01-31');
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **ìš´ì˜ í™˜ê²½**
   - 07_insert_initial_data.sqlì€ ìƒ˜í”Œ ë°ì´í„°ì´ë¯€ë¡œ ì‹¤í–‰í•˜ì§€ ë§ˆì„¸ìš”
   - 99_rollback.sqlì€ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ë¯€ë¡œ ì ˆëŒ€ ì‹¤í–‰í•˜ì§€ ë§ˆì„¸ìš”

2. **ë°±ì—…**
   - ì¤‘ìš”í•œ ì‘ì—… ì „ ë°˜ë“œì‹œ ë°±ì—…í•˜ì„¸ìš”
   - ë¡¤ë°± ì „ ë°ì´í„°ë¥¼ ë°±ì—…í•˜ì„¸ìš”

3. **ê¶Œí•œ**
   - CREATE, DROP, ALTER ê¶Œí•œ í•„ìš”
   - TRIGGER, PROCEDURE ìƒì„± ê¶Œí•œ í•„ìš”

## âœ… ê²€ì¦ ì™„ë£Œ

- âœ… ëª¨ë“  ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ìƒì„± ì™„ë£Œ
- âœ… SQL ë¬¸ë²• ê²€ì¦ ì™„ë£Œ
- âœ… ì‹¤í–‰ ìˆœì„œ ëª…í™•íˆ ì •ì˜
- âœ… ì£¼ì„ ë° ì„¤ëª… í¬í•¨
- âœ… í•œê¸€ ì£¼ì„ ë° README ì‘ì„±
- âœ… ìƒ˜í”Œ ë°ì´í„° í¬í•¨
- âœ… ë¡¤ë°± ìŠ¤í¬ë¦½íŠ¸ ì œê³µ

---

**ì‘ì—… ì™„ë£Œì¼**: 2025-11-23  
**ë°ì´í„°ë² ì´ìŠ¤**: trading_journal  
**DBMS**: MySQL 8.0+  
**ì´ íŒŒì¼ ìˆ˜**: 9ê°œ
