# 대시보드 차트 개선

## 📅 작업 일시
**2025-11-26**

---

## 🎯 작업 배경

기존 대시보드에는 단순한 누적 손익 라인 차트만 있어서 투자 성과를 다각도로 분석하기 어려웠습니다. 월별 손익 추이, 종목별 분포, 주요 통계 등을 한눈에 파악할 수 있는 대시보드가 필요했습니다.

---

## 💡 기술적 결정 사항

### 1. 차트 라이브러리

**선택**: Recharts (기존 사용 중)

**이유**:
- ✅ **이미 설치됨**: 추가 의존성 불필요
- ✅ **React 친화적**: 컴포넌트 기반
- ✅ **다양한 차트**: Line, Bar, Pie 모두 지원
- ✅ **반응형**: ResponsiveContainer 제공

### 2. 컴포넌트 구조

**선택**: 개별 차트 컴포넌트 분리

**이유**:
- ✅ **재사용성**: 각 차트를 독립적으로 사용 가능
- ✅ **유지보수**: 각 차트의 로직 분리
- ✅ **테스트**: 개별 컴포넌트 테스트 용이

### 3. 데이터 처리

**선택**: 유틸리티 함수 분리 (chartUtils.ts)

**이유**:
- ✅ **재사용성**: 여러 컴포넌트에서 사용
- ✅ **테스트**: 순수 함수로 테스트 용이
- ✅ **성능**: useMemo로 캐싱

---

## 🛠 구현 내용

### 1. 생성된 파일 (6개)

#### 📄 [utils/chartUtils.ts](file:///c:/workdir/space-cap/trading-journal/frontend/src/utils/chartUtils.ts)

**주요 함수**:

##### 1) 월별 데이터 집계
```typescript
export function aggregateByMonth(trades: Trade[]) {
  // 청산된 매매만 집계
  // 월별로 수익/손실 분리
  // 매매 건수 포함
  return monthlyData;
}
```

##### 2) 종목별 데이터 집계
```typescript
export function aggregateBySymbol(trades: Trade[]) {
  // 상위 5개 종목 추출
  // 나머지는 "기타"로 그룹화
  return symbolData;
}
```

##### 3) 누적 손익 데이터
```typescript
export function getCumulativeData(trades: Trade[]) {
  // 청산일 기준 정렬
  // 누적 손익 계산
  return cumulativeData;
}
```

##### 4) 통계 계산
```typescript
export function calculateStats(trades: Trade[]) {
  // 총 손익, 승률, 평균 손익, 최대 수익/손실
  return stats;
}
```

---

#### 📄 [components/charts/StatsCard.tsx](file:///c:/workdir/space-cap/trading-journal/frontend/src/components/charts/StatsCard.tsx)

**통계 카드 컴포넌트**:
```tsx
<StatsCard
  title="총 손익"
  value={1234.56}
  color="green"  // green, red, blue, purple, gray
  icon="💰"
/>
```

**색상 테마**:
- 초록: 수익 관련
- 빨강: 손실 관련
- 파랑: 승률 등
- 보라: 최대값 등

---

#### 📄 [components/charts/CumulativePnlChart.tsx](file:///c:/workdir/space-cap/trading-journal/frontend/src/components/charts/CumulativePnlChart.tsx)

**누적 손익 라인 차트**:
- 시간에 따른 누적 손익 추이
- 초록색 라인 (#10b981)
- 날짜별 표시 (MM/DD)

---

#### 📄 [components/charts/MonthlyPnlChart.tsx](file:///c:/workdir/space-cap/trading-journal/frontend/src/components/charts/MonthlyPnlChart.tsx)

**월별 손익 막대 차트**:
- 수익: 초록색 막대 (#10b981)
- 손실: 빨강색 막대 (#ef4444)
- 월별 순손익 계산

---

#### 📄 [components/charts/SymbolDistributionChart.tsx](file:///c:/workdir/space-cap/trading-journal/frontend/src/components/charts/SymbolDistributionChart.tsx)

**종목별 분포 파이 차트**:
- 상위 5개 종목 표시
- 나머지는 "기타"로 그룹화
- 6가지 색상 팔레트

---

### 2. 수정된 파일 (3개)

#### 📄 [DashboardChart.tsx](file:///c:/workdir/space-cap/trading-journal/frontend/src/components/DashboardChart.tsx)

**변경 사항**:
- 단순 차트 → 종합 대시보드로 변경
- useMemo로 데이터 처리 최적화
- 그리드 레이아웃 적용

**레이아웃**:
```
┌─────────────────────────────────────┐
│  통계 카드 (4개)                     │
│  [총 손익] [승률] [평균] [최대]      │
├──────────────────┬──────────────────┤
│  누적 손익 차트   │  월별 손익 차트   │
├──────────────────┴──────────────────┤
│  종목별 분포 차트                    │
└─────────────────────────────────────┘
```

---

#### 📄 [locales/ko.json](file:///c:/workdir/space-cap/trading-journal/frontend/src/locales/ko.json)

**추가된 번역**:
```json
{
  "dashboard": {
    "totalPnl": "총 손익",
    "winRate": "승률",
    "avgPnl": "평균 손익",
    "maxProfit": "최대 수익",
    "cumulativePnl": "누적 손익 추이",
    "monthlyPnl": "월별 손익",
    "symbolDistribution": "종목별 분포",
    "cumulative": "누적",
    "profit": "수익",
    "loss": "손실"
  }
}
```

---

#### 📄 [locales/en.json](file:///c:/workdir/space-cap/trading-journal/frontend/src/locales/en.json)

**추가된 번역**:
```json
{
  "dashboard": {
    "totalPnl": "Total P&L",
    "winRate": "Win Rate",
    "avgPnl": "Avg P&L",
    "maxProfit": "Max Profit",
    "cumulativePnl": "Cumulative P&L Trend",
    "monthlyPnl": "Monthly P&L",
    "symbolDistribution": "Symbol Distribution",
    "cumulative": "Cumulative",
    "profit": "Profit",
    "loss": "Loss"
  }
}
```

---

## 📊 변경 통계

### 파일 변경
- **신규 생성**: 6개 (chartUtils.ts + 차트 컴포넌트 5개)
- **수정**: 3개 (DashboardChart.tsx, ko.json, en.json)

### 코드 라인
- **추가**: 약 350줄

### 번역 항목
- **추가된 번역 키**: 10개

---

## 🎨 UI 개선

### Before (단순 차트)
```
┌─ 수익 차트 ──────────────┐
│                          │
│  [누적 손익 라인 차트]    │
│                          │
└──────────────────────────┘
```

### After (종합 대시보드)
```
┌─────────────────────────────────────┐
│ 💰 총 손익  📊 승률  📈 평균  🎯 최대│
│  +1,234    65.5%   +82.3    +450   │
├──────────────────┬──────────────────┤
│  누적 손익 추이   │  월별 손익       │
│  [라인 차트]     │  [막대 차트]     │
├──────────────────┴──────────────────┤
│  종목별 분포                        │
│  [파이 차트]                        │
└─────────────────────────────────────┘
```

---

## ✅ 테스트 결과

### 기능 테스트
1. ✅ 통계 카드 정확성 (총 손익, 승률, 평균, 최대)
2. ✅ 누적 손익 차트 표시
3. ✅ 월별 손익 차트 표시 (수익/손실 구분)
4. ✅ 종목별 분포 차트 표시 (상위 5개 + 기타)
5. ✅ 한글/영문 번역 확인

### 데이터 처리 테스트
1. ✅ 월별 집계 정확성
2. ✅ 종목별 집계 정확성
3. ✅ 누적 손익 계산 정확성
4. ✅ 통계 계산 정확성

### 성능 테스트
1. ✅ useMemo로 불필요한 재계산 방지
2. ✅ 대량 데이터에서도 부드러운 렌더링

### 반응형 테스트
1. ✅ 데스크톱: 2열 그리드
2. ✅ 태블릿: 2열 그리드
3. ✅ 모바일: 1열 스택

---

## 🎓 회고

### 잘한 점
1. ✅ **다양한 시각화**: 라인, 막대, 파이 차트로 다각도 분석
2. ✅ **통계 요약**: 주요 지표를 카드로 한눈에 표시
3. ✅ **컴포넌트 분리**: 재사용 가능한 구조
4. ✅ **성능 최적화**: useMemo로 효율적인 계산
5. ✅ **반응형 디자인**: 다양한 화면 크기 지원

### 개선할 점
1. ⚠️ **차트 인터랙션**: 클릭 시 상세 정보 표시 미구현
2. ⚠️ **기간 선택**: 대시보드에서 기간 필터 미구현
3. ⚠️ **차트 내보내기**: 이미지로 저장 기능 없음
4. ⚠️ **실시간 업데이트**: 차트 애니메이션 미구현
5. ⚠️ **추가 통계**: 샤프 비율, 최대 낙폭 등 미구현

### 배운 점
1. 💡 **Recharts 활용**: 다양한 차트 타입 사용법
2. 💡 **데이터 집계**: Map을 활용한 효율적인 집계
3. 💡 **색상 팔레트**: 일관된 색상 테마의 중요성
4. 💡 **useMemo 최적화**: 복잡한 계산의 성능 개선

---

## 🚀 향후 작업

### 단기 개선 사항
- [ ] 차트 클릭 시 상세 정보 모달
- [ ] 대시보드 기간 필터 (오늘, 이번주, 이번달)
- [ ] 차트 툴팁 개선 (더 많은 정보)

### 중기 확장
- [ ] 차트 이미지 내보내기
- [ ] 차트 애니메이션 효과
- [ ] 추가 통계 (샤프 비율, MDD)
- [ ] 비교 차트 (전월 대비 등)

### 장기 확장
- [ ] 커스텀 대시보드 (위젯 배치)
- [ ] 실시간 차트 업데이트
- [ ] 고급 기술적 지표
- [ ] PDF 리포트 생성

---

## 📚 참고 자료

- [Recharts Documentation](https://recharts.org/)
- [React useMemo](https://react.dev/reference/react/useMemo)
- [Data Visualization Best Practices](https://www.tableau.com/learn/articles/data-visualization)

---

**작성자**: Antigravity AI  
**작업 완료일**: 2025-11-26  
**소요 시간**: 약 1시간 30분  
**난이도**: ⭐⭐⭐⭐ (중상)
